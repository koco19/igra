p.accuracy=0.001, r.accuracy=0.01,
label.x.npc=0.5, label.y.npc = 0.1,
show.legend=FALSE, size=3) +
scale_y_continuous(trans="log2", breaks=c(0.1, 40, 2500),
labels=c(0, 40, 2500)) +
scale_x_continuous(trans="log2", breaks=c(0.5, 5, 100),
labels=c(0.5, 5, 100)) +
theme(legend.position="none")
fig4a
# Figure 4b
# Number of individuals for the 4 antigens (subset of the previous one)
n.ind2 <- data.long %>%
filter(!is.na(Group.5)) %>%
filter(Antigen %in% c("Capsid", "Membrane", "SCT", "SNT")) %>%
select(LabId, Group.5, Antigen, value) %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(Capsid) | is.na(Membrane) | is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
group_by(Group.5) %>%
count() %>%
rename(n.ind = n)
n.ind2
r <- data %>% select(LabId, Roche)
fig4b <- data.long %>%
select(LabId, Group.5, Antigen, value, Roche) %>%
filter(!is.na(Group.5)) %>%
filter(Antigen %in% c("Capsid", "SCT", "Membrane", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(Capsid) | is.na(Membrane) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5, -Roche) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5 %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive")) %>%
#   mutate(Group.5 = case_when(
# #    Group.5 == "Controls" ~ "Controls",
#     Group.5 == "PCR+ Seropositive" ~ "PCR+\nSeropositive",
#     Group.5 == "PCR+ Seronegative" ~ "PCR+\nSeronegative",
#     Group.5 == "Exposed Seropositive" ~ "Exposed\nSeropositive")) %>%#,
#Group.5 == "Exposed Seronegative" ~ "Exposed\nSeronegative")) %>%
# mutate(Group.5 = paste(Group.5, "(n=", n.ind, ")")) %>%
ggplot(aes(y=Roche, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5), width=0.3, alpha=0.6) +
# scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("Ro-N-Ig") +
geom_hline(yintercept = 0.422, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5, y=Roche,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=Roche, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4b
plot_grid(fig4a, fig4b, labels=c("A", "B"),
rel_widths=c(0.45, 0.55))
ggsave(here_output("Figure_4.pdf"), height=5, width=12)
ggsave(here_output("Figure_4.png"), height=5, width=12)
figSI1 <- data.long %>%
filter(!is.na(Group.5)) %>%
filter(Group.5 %in% c("Exposed Seropositive", "PCR+ Seropositive",
"PCR+ Seronegative")) %>%
filter(Antigen %in% c("Capsid", "Membrane", "SCT", "SNT")) %>%
mutate(value = ifelse(value == 0, 0.1, value)) %>%
ggplot() +
geom_point(aes(y=value, x=IgG, color=Group.5), alpha=0.4) +
facet_wrap(~Antigen) +
scale_color_manual(values=cbPalette[c(6, 8, 4)], name="Group") +
geom_hline(yintercept=40, color="grey5", lty=3) +
geom_vline(xintercept = 1.015, color="grey5", lty=3) +
xlab("EI-S1-IgG") + ylab(expression(paste("IFN", gamma, " (mU/ml)"))) +
stat_smooth(aes(x=IgG, y=value), lty=1, se=FALSE,
color="grey50", formula = y ~ x, method="lm") +
ggpubr::stat_cor(aes(y=value, x=IgG, hjust=0, vjust=0),
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3) +
scale_y_continuous(trans="log2", breaks=c(0.1, 40, 2500),
labels=c(0, 40, 2500)) +
scale_x_continuous(trans="log2", breaks=c(0.25, 1, 5),
labels=c(0.25, 1, 5))
figSI1
fig4a <- data.long.b %>%
filter(!is.na(Group.5b)) %>%
filter(Group.5b %in% c("Exposed Seropositive", "PCR+ Seropositive",
"PCR+ Seronegative")) %>%
filter(Antigen %in% c("Capsid", "Membrane", "SCT", "SNT")) %>%
mutate(value = ifelse(value == 0, 0.1, value)) %>%
ggplot() +
geom_point(aes(y=value, x=Roche, color=Group.5b), alpha=0.4) +
facet_wrap(~Antigen) +
scale_color_manual(values=cbPalette[c(6, 8, 4)], name="Group") +
geom_hline(yintercept=40, color="grey5", lty=3) +
geom_vline(xintercept = 0.422, color="grey5", lty=3) +
xlab("Ro-N-Ig") + ylab(expression(paste("IFN", gamma, " (mU/ml)"))) +
stat_smooth(aes(x=Roche, y=value), lty=1, se=FALSE,
color="grey50", formula = y ~ x, method="lm") +
ggpubr::stat_cor(aes(y=value, x=Roche, hjust=0, vjust=0),
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc=0.5, label.y.npc = 0.1,
show.legend=FALSE, size=3) +
scale_y_continuous(trans="log2", breaks=c(0.1, 40, 2500),
labels=c(0, 40, 2500)) +
scale_x_continuous(trans="log2", breaks=c(0.5, 5, 100),
labels=c(0.5, 5, 100)) +
theme(legend.position="none")
fig4a
# Number of individuals for the 4 antigens (subset of the previous one)
n.ind2 <- data.long.b %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("Capsid", "Membrane", "SCT", "SNT")) %>%
select(LabId, Group.5b, Antigen, value) %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(Capsid) | is.na(Membrane) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
group_by(Group.5b) %>%
count() %>%
rename(n.ind = n)
n.ind2
r <- data %>% select(LabId, Roche)
fig4b <- data.long.b %>%
select(LabId, Group.5b, Antigen, value, Roche) %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("Capsid", "SCT", "Membrane", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(Capsid) | is.na(Membrane) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5b, -Roche) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5b, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5b)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5b %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive", "Exposed Seronegative")) %>%
#   mutate(Group.5 = case_when(
# #    Group.5 == "Controls" ~ "Controls",
#     Group.5 == "PCR+ Seropositive" ~ "PCR+\nSeropositive",
#     Group.5 == "PCR+ Seronegative" ~ "PCR+\nSeronegative",
#     Group.5 == "Exposed Seropositive" ~ "Exposed\nSeropositive")) %>%#,
#Group.5 == "Exposed Seronegative" ~ "Exposed\nSeronegative")) %>%
# mutate(Group.5 = paste(Group.5, "(n=", n.ind, ")")) %>%
ggplot(aes(y=Roche, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5b), width=0.3, alpha=0.6) +
# scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("Ro-N-Ig") +
geom_hline(yintercept = 0.422, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(1, 6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5b, y=Roche,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=Roche, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4b
r <- data %>% select(LabId, IgG) %>%
mutate(IgG = as.numeric(IgG))
fig4c <- data.long.b %>%
select(LabId, Group.5b, Antigen, value, IgG) %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("Capsid", "SCT", "Membrane", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(Capsid) | is.na(Membrane) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5b, -IgG) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5b, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5b)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5b %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive", "Exposed Seronegative")) %>%
#   mutate(Group.5 = case_when(
# #    Group.5 == "Controls" ~ "Controls",
#     Group.5 == "PCR+ Seropositive" ~ "PCR+\nSeropositive",
#     Group.5 == "PCR+ Seronegative" ~ "PCR+\nSeronegative",
#     Group.5 == "Exposed Seropositive" ~ "Exposed\nSeropositive")) %>%#,
#Group.5 == "Exposed Seronegative" ~ "Exposed\nSeronegative")) %>%
# mutate(Group.5 = paste(Group.5, "(n=", n.ind, ")")) %>%
ggplot(aes(y=IgG, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5b), width=0.3, alpha=0.6) +
#scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("EI-S1-IgG") +
geom_hline(yintercept = 1.015, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(1, 6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5b, y=IgG,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=IgG, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4c
plot_grid(fig4b, fig4c, labels=c("A", "B"),
rel_widths=c(0.5, 0.5))
data.long %>%
filter(Antigen %in% c("Capsid", "Membrane", "SCT", "SNT")) %>%
filter(Group.5 %in% c("Controls", "Exposed Seronegative")) %>%
ggplot() +
geom_jitter(aes(x=Group.5, y=value, color=Antigen), alpha=0.4) +
geom_boxplot(aes(x=Group.5, y=value), width=0.2) +
scale_y_log10() +
geom_hline(yintercept=40, col="grey", lty=2)
data.long %>%
mutate(threshold = ifelse(value >= 40, 1, 0)) %>%
group_by(LabId, threshold) %>%
count()
library(dplyr)
library(ggplot2)
library(tidyr)
library(ggthemes)
library(colorspace)
library(readxl)
library(forcats)
library(scales)
library(gridExtra)
library(cowplot)
library(Cairo)
library(stringr)
library(ggpubr)
library(rstatix)
library(EnvStats)
library(lme4)
library(effects)
library(broom)
library(broom.mixed)
library(extrafont)
loadfonts(quiet = TRUE)
library(ggthemes)
# Define theme and colors
theme_set(theme_classic())
theme_update(strip.background = element_rect(colour = "white", fill = "white"))
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
here_r = function (...) here::here("Statistics", ...)
here_data_tcell = function (...) here::here("Data-t-cell", ...)
here_data_bd = function (...) here::here("Data-blood-donors", ...)
here_output = function (...) here::here("Output", ...)
# Load data of t-cell
load(here_data_tcell("data-raw-tcell-210315.RData"))
data <- data %>%
rename(Capsid = "Capsid sub x5",
Membrane = "Membrane sub x5",
SNT = "SNT sub x5",
SCT = "SCT sub x5",
`Pepmix (green)` = "gr端n sbu x5",
`Pepmix (yellow)` = "yellow sub x5")
data.long <- data.long %>%
mutate(Antigen = case_when(
Antigen == "Capsid sub x5" ~ "Capsid",
Antigen == "Membrane sub x5" ~ "Membrane",
Antigen == "SNT sub x5" ~ "SNT",
Antigen == "SCT sub x5" ~ "SCT",
Antigen == "gr端n sbu x5" ~ "Pepmix (green)",
Antigen == "yellow sub x5" ~ "Pepmix (yellow)"))
data.long <- data.long %>%
mutate(IgG = as.numeric(IgG))
data <- data %>%
mutate(IgG = as.numeric(IgG))
# Load blood donors data
bd.raw <- read.csv(here_data_bd("Final_Lab_Single_20200904.csv"))
head(bd.raw)
table(bd.raw$study_per_ID)
# Load function to extract last values (from lab paper)
source("~/co/CovSKMuc/Statistics/R/functions.R")
dim(bd.raw)
bd.raw <- extract_last_values(bd.raw)
dim(bd.raw)
head(bd.raw)
bd <- bd.raw %>%
filter(study_per_ID %in% c("BloodDonor_Mar20", "BloodDonor_Oct19")) %>%
select(tln_ID, Roche, Eur_IgG, study_per_ID) %>%
rename(LabId = tln_ID) %>%
rename(IgG = Eur_IgG,
Group.5 = study_per_ID) %>%
mutate(Group.5 = case_when(
Group.5 == "BloodDonor_Mar20" ~ "Blood Donors (Mar20)",
Group.5 == "BloodDonor_Oct19" ~ "Blood Donors (Oct19)"))
data <- bind_rows(data, bd)
dim(data)
# Set up the comparisons
my.comparisons <- list(c("Blood Donors (Oct19)", "Controls"),
c("Blood Donors (Oct19)", "Exposed Seronegative"),
c("Blood Donors (Oct19)", "PCR+ Seronegative"),
c("Controls", "Exposed Seronegative"),
c("Controls", "PCR+ Seronegative"),
c("Exposed Seronegative", "PCR+ Seronegative"))
data.wilcox <- data %>%
filter(Group.5 %in% c("Blood Donors (Oct19)", "Controls",
"Exposed Seronegative", "PCR+ Seronegative"))
wilcox.results <- wilcox_test(Roche~Group.5, data=data.wilcox,
p.adjust.method = "bonferroni")
fig.s1 <- data %>%
filter(Group.5 %in% c("Blood Donors (Oct19)",
"Controls", "Exposed Seronegative",
"PCR+ Seronegative")) %>%
# mutate(Group.5 = ifelse(Group.5 == "Blood Donors (Oct19)",
#                         "Blood Donors", Group.5)) %>%
ggplot(aes(x=Group.5, y=Roche)) +
geom_jitter(alpha=0.4, aes(color=Group.5)) +
geom_boxplot(width=0.2, col="black") +
scale_y_log10() +
scale_color_manual(values=cbPalette[c(1,2,3,8)], name="Group") +
geom_hline(yintercept = 0.442, color="grey", lty=2) +
theme(axis.text.x = element_text(angle = 90)) +
xlab("") + ylab("Ro-N-Ig") +
stat_compare_means(label.y = 0.25, show.legend=FALSE) +
# stat_pvalue_manual(wilcox.results, label = "p.adj.signif",
#                    step.increase = 0.06, size=3)
stat_compare_means(comparisons = my.comparisons, method="wilcox.test",
step.increase=0.1, label="p.signif", hide.ns = TRUE) +
theme(legend.position = "none")
fig.s1
ggsave(here_output("Figure_S1.pdf"), height=5, width=6)
ggsave(here_output("Figure_S1.png"), height=5, width=6)
data %>%
filter(Group.5 %in% c("PCR+ Seronegative")) %>%
filter(!is.na(IgG)) %>%
mutate(Seropositivity.IgG = case_when(
Seropositivity.IgG == "Negative" ~ "EI-S1-IgG negative",
Seropositivity.IgG == "Positive" ~ "EI-S1-IgG positive")) %>%
ggplot(aes(x=Seropositivity.IgG, y=IgG)) +
stat_summary(geom = "point", fun = "median", col = "black",
size = 7, shape=95) +
geom_jitter(width=0.1, alpha=0.4, color=cbPalette[8]) +
theme_classic() +
ylab("EI-S1-IgG") +
xlab("") +
geom_hline(yintercept = 1.015, col="grey", lty=2) +
stat_n_text(size=3, y.pos=-1)
ggsave(here_output("Figure_S2.pdf"), height=4, width=4)
ggsave(here_output("Figure_S2.pdf"), height=4, width=4)
library(dplyr)
library(ggplot2)
library(tidyr)
library(ggthemes)
library(colorspace)
library(readxl)
library(forcats)
library(scales)
library(gridExtra)
library(cowplot)
library(Cairo)
library(stringr)
library(ggpubr)
library(rstatix)
library(EnvStats)
library(lme4)
library(effects)
library(broom)
library(broom.mixed)
library(extrafont)
loadfonts(quiet = TRUE)
library(ggthemes)
# Define theme and colors
theme_set(theme_classic())
theme_update(strip.background = element_rect(colour = "white", fill = "white"))
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
here_r = function (...) here::here("Statistics", ...)
here_data_tcell = function (...) here::here("Data-t-cell", ...)
here_data_bd = function (...) here::here("Data-blood-donors", ...)
here_output = function (...) here::here("Output", ...)
# Load data of t-cell
load(here_data_tcell("data-raw-tcell-210315.RData"))
data <- data %>%
rename(Capsid = "Capsid sub x5",
Membrane = "Membrane sub x5",
SNT = "SNT sub x5",
SCT = "SCT sub x5",
`Pepmix (green)` = "gr端n sbu x5",
`Pepmix (yellow)` = "yellow sub x5")
data.long <- data.long %>%
mutate(Antigen = case_when(
Antigen == "Capsid sub x5" ~ "Capsid",
Antigen == "Membrane sub x5" ~ "Membrane",
Antigen == "SNT sub x5" ~ "SNT",
Antigen == "SCT sub x5" ~ "SCT",
Antigen == "gr端n sbu x5" ~ "Pepmix (green)",
Antigen == "yellow sub x5" ~ "Pepmix (yellow)"))
data.long <- data.long %>%
mutate(IgG = as.numeric(IgG))
data <- data %>%
mutate(IgG = as.numeric(IgG))
# Load blood donors data
bd.raw <- read.csv(here_data_bd("Final_Lab_Single_20200904.csv"))
head(bd.raw)
table(bd.raw$study_per_ID)
# Load function to extract last values (from lab paper)
source("~/co/CovSKMuc/Statistics/R/functions.R")
dim(bd.raw)
bd.raw <- extract_last_values(bd.raw)
dim(bd.raw)
head(bd.raw)
bd <- bd.raw %>%
filter(study_per_ID %in% c("BloodDonor_Mar20", "BloodDonor_Oct19")) %>%
select(tln_ID, Roche, Eur_IgG, study_per_ID) %>%
rename(LabId = tln_ID) %>%
rename(IgG = Eur_IgG,
Group.5 = study_per_ID) %>%
mutate(Group.5 = case_when(
Group.5 == "BloodDonor_Mar20" ~ "Blood Donors (Mar20)",
Group.5 == "BloodDonor_Oct19" ~ "Blood Donors (Oct19)"))
data <- bind_rows(data, bd)
dim(data)
# Set up the comparisons
my.comparisons <- list(c("Blood Donors (Oct19)", "Controls"),
c("Blood Donors (Oct19)", "Exposed Seronegative"),
c("Blood Donors (Oct19)", "PCR+ Seronegative"),
c("Controls", "Exposed Seronegative"),
c("Controls", "PCR+ Seronegative"),
c("Exposed Seronegative", "PCR+ Seronegative"))
data.wilcox <- data %>%
filter(Group.5 %in% c("Blood Donors (Oct19)", "Controls",
"Exposed Seronegative", "PCR+ Seronegative"))
wilcox.results <- wilcox_test(Roche~Group.5, data=data.wilcox,
p.adjust.method = "bonferroni")
fig.s1 <- data %>%
filter(Group.5 %in% c("Blood Donors (Oct19)",
"Controls", "Exposed Seronegative",
"PCR+ Seronegative")) %>%
# mutate(Group.5 = ifelse(Group.5 == "Blood Donors (Oct19)",
#                         "Blood Donors", Group.5)) %>%
ggplot(aes(x=Group.5, y=Roche)) +
geom_jitter(alpha=0.4, aes(color=Group.5)) +
geom_boxplot(width=0.2, col="black") +
scale_y_log10() +
scale_color_manual(values=cbPalette[c(1,2,3,8)], name="Group") +
geom_hline(yintercept = 0.442, color="grey", lty=2) +
theme(axis.text.x = element_text(angle = 90)) +
xlab("") + ylab("Ro-N-Ig") +
stat_compare_means(label.y = 0.25, show.legend=FALSE) +
# stat_pvalue_manual(wilcox.results, label = "p.adj.signif",
#                    step.increase = 0.06, size=3)
stat_compare_means(comparisons = my.comparisons, method="wilcox.test",
step.increase=0.1, label="p.signif", hide.ns = TRUE) +
theme(legend.position = "none")
fig.s1
ggsave(here_output("Figure_S1.pdf"), height=5, width=6)
ggsave(here_output("Figure_S1.png"), height=5, width=6)
data %>%
filter(Group.5 %in% c("PCR+ Seronegative")) %>%
filter(!is.na(IgG)) %>%
mutate(Seropositivity.IgG = case_when(
Seropositivity.IgG == "Negative" ~ "EI-S1-IgG negative",
Seropositivity.IgG == "Positive" ~ "EI-S1-IgG positive")) %>%
ggplot(aes(x=Seropositivity.IgG, y=IgG)) +
stat_summary(geom = "point", fun = "median", col = "black",
size = 7, shape=95) +
geom_jitter(width=0.1, alpha=0.4, color=cbPalette[8]) +
theme_classic() +
ylab("EI-S1-IgG") +
xlab("") +
geom_hline(yintercept = 1.015, col="grey", lty=2) +
stat_n_text(size=3, y.pos=-1)
ggsave(here_output("Figure_S2.pdf"), height=4, width=4)
ggsave(here_output("Figure_S2.png"), height=4, width=4)
