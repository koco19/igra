color="grey50", formula = y ~ x, method="lm") +
ggpubr::stat_cor(aes(y=value, x=Roche, hjust=0, vjust=0),
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc=0.5, label.y.npc = 0.1,
show.legend=FALSE, size=3) +
scale_y_continuous(trans="log2", breaks=c(0.1, 40, 2500),
labels=c(0, 40, 2500)) +
scale_x_continuous(trans="log2", breaks=c(0.5, 5, 100),
labels=c(0.5, 5, 100)) +
theme(legend.position="none")
fig4a
# Figure 4b
# Number of individuals for the 4 antigens (subset of the previous one)
n.ind2 <- data.long %>%
filter(!is.na(Group.5)) %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
select(LabId, Group.5, Antigen, value) %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(NC) | is.na(M) | is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
group_by(Group.5) %>%
count() %>%
rename(n.ind = n)
n.ind2
r <- data %>% select(LabId, Roche)
fig4b <- data.long %>%
select(LabId, Group.5, Antigen, value, Roche) %>%
filter(!is.na(Group.5)) %>%
filter(Antigen %in% c("NC", "SCT", "M", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(NC) | is.na(M) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5, -Roche) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5 %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive")) %>%
#   mutate(Group.5 = case_when(
# #    Group.5 == "Controls" ~ "Controls",
#     Group.5 == "PCR+ Seropositive" ~ "PCR+\nSeropositive",
#     Group.5 == "PCR+ Seronegative" ~ "PCR+\nSeronegative",
#     Group.5 == "Exposed Seropositive" ~ "Exposed\nSeropositive")) %>%#,
#Group.5 == "Exposed Seronegative" ~ "Exposed\nSeronegative")) %>%
# mutate(Group.5 = paste(Group.5, "(n=", n.ind, ")")) %>%
ggplot(aes(y=Roche, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5), width=0.3, alpha=0.6) +
# scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("Ro-N-Ig") +
geom_hline(yintercept = 0.422, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5, y=Roche,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=Roche, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4b
plot_grid(fig4a, fig4b, labels=c("A", "B"),
rel_widths=c(0.45, 0.55))
ggsave(here_output("Figure_4.pdf"), height=5, width=12)
ggsave(here_output("Figure_4.png"), height=5, width=12)
figSI1 <- data.long %>%
filter(!is.na(Group.5)) %>%
filter(Group.5 %in% c("Exposed Seropositive", "PCR+ Seropositive",
"PCR+ Seronegative")) %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
mutate(value = ifelse(value == 0, 0.1, value)) %>%
ggplot() +
geom_point(aes(y=value, x=IgG, color=Group.5), alpha=0.4) +
facet_wrap(~fct_inorder(Antigen)) +
scale_color_manual(values=cbPalette[c(6, 8, 4)], name="Group") +
geom_hline(yintercept=40, color="grey5", lty=3) +
geom_vline(xintercept = 1.015, color="grey5", lty=3) +
xlab("EI-S1-IgG") + ylab(expression(paste("IFN", gamma, " (mU/ml)"))) +
stat_smooth(aes(x=IgG, y=value), lty=1, se=FALSE,
color="grey50", formula = y ~ x, method="lm") +
ggpubr::stat_cor(aes(y=value, x=IgG, hjust=0, vjust=0),
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3) +
scale_y_continuous(trans="log2", breaks=c(0.1, 40, 2500),
labels=c(0, 40, 2500)) +
scale_x_continuous(trans="log2", breaks=c(0.25, 1, 5),
labels=c(0.25, 1, 5))
figSI1
figSI1 <- data.long %>%
filter(!is.na(Group.5)) %>%
filter(Group.5 %in% c("Exposed Seropositive", "PCR+ Seropositive",
"PCR+ Seronegative")) %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
mutate(value = ifelse(value == 0, 0.1, value)) %>%
ggplot() +
geom_point(aes(y=value, x=IgG, color=Group.5), alpha=0.4) +
facet_wrap(~fct_inorder(Antigen)) +
scale_color_manual(values=cbPalette[c(6, 8, 4)], name="Group") +
geom_hline(yintercept=40, color="grey5", lty=3) +
geom_vline(xintercept = 1.015, color="grey5", lty=3) +
xlab("EI-S1-IgG") + ylab(expression(paste("IFN", gamma, " (mIU/ml)"))) +
stat_smooth(aes(x=IgG, y=value), lty=1, se=FALSE,
color="grey50", formula = y ~ x, method="lm") +
ggpubr::stat_cor(aes(y=value, x=IgG, hjust=0, vjust=0),
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3) +
scale_y_continuous(trans="log2", breaks=c(0.1, 40, 2500),
labels=c(0, 40, 2500)) +
scale_x_continuous(trans="log2", breaks=c(0.25, 1, 5),
labels=c(0.25, 1, 5))
figSI1
ggsave(here_output("Figure_S1.pdf"), height=5, width=8)
ggsave(here_output("Figure_S1.png"), height=5, width=8)
# Number of individuals for the 4 antigens
# (subset of the previous one)
n.ind2 <- data.long.b %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
select(LabId, Group.5b, Antigen, value) %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(NC) | is.na(M) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
group_by(Group.5b) %>%
count() %>%
rename(n.ind = n)
n.ind2
r <- data %>% select(LabId, Roche)
fig4b <- data.long.b %>%
select(LabId, Group.5b, Antigen, value, Roche) %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("NC", "SCT", "M", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(NC) | is.na(M) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5b, -Roche) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5b, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5b)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5b %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive", "Exposed Seronegative")) %>%
#   mutate(Group.5 = case_when(
# #    Group.5 == "Controls" ~ "Controls",
#     Group.5 == "PCR+ Seropositive" ~ "PCR+\nSeropositive",
#     Group.5 == "PCR+ Seronegative" ~ "PCR+\nSeronegative",
#     Group.5 == "Exposed Seropositive" ~ "Exposed\nSeropositive")) %>%#,
#Group.5 == "Exposed Seronegative" ~ "Exposed\nSeronegative")) %>%
# mutate(Group.5 = paste(Group.5, "(n=", n.ind, ")")) %>%
ggplot(aes(y=Roche, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5b), width=0.3, alpha=0.6) +
# scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("Ro-N-Ig") +
geom_hline(yintercept = 0.422, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(1, 6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5b, y=Roche,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=Roche, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4b
r <- data %>% select(LabId, IgG) %>%
mutate(IgG = as.numeric(IgG))
fig4c <- data.long.b %>%
select(LabId, Group.5b, Antigen, value, IgG) %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("NC", "SCT", "M", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(Capsid) | is.na(Membrane) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5b, -IgG) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5b, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5b)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5b %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive", "Exposed Seronegative")) %>%
#   mutate(Group.5 = case_when(
# #    Group.5 == "Controls" ~ "Controls",
#     Group.5 == "PCR+ Seropositive" ~ "PCR+\nSeropositive",
#     Group.5 == "PCR+ Seronegative" ~ "PCR+\nSeronegative",
#     Group.5 == "Exposed Seropositive" ~ "Exposed\nSeropositive")) %>%#,
#Group.5 == "Exposed Seronegative" ~ "Exposed\nSeronegative")) %>%
# mutate(Group.5 = paste(Group.5, "(n=", n.ind, ")")) %>%
ggplot(aes(y=IgG, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5b), width=0.3, alpha=0.6) +
#scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("EI-S1-IgG") +
geom_hline(yintercept = 1.015, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(1, 6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5b, y=IgG,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=IgG, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4c <- data.long.b %>%
select(LabId, Group.5b, Antigen, value, IgG) %>%
filter(!is.na(Group.5b)) %>%
filter(Antigen %in% c("NC", "SCT", "M", "SNT")) %>%
droplevels() %>%
spread(Antigen, value) %>%
mutate(complete = ifelse(is.na(NC) | is.na(M) |
is.na(SCT) | is.na(SNT),
"remove", "keep")) %>%
filter(complete %in% "keep") %>%
droplevels() %>%
select(-complete) %>%
gather(Antigen, value, -LabId, -Group.5b, -IgG) %>%
mutate(threshold = ifelse(value >40, "Above", "Below")) %>%
filter(!is.na(threshold)) %>%
group_by(LabId, Group.5b, threshold) %>%
count() %>%
spread(threshold, n) %>%
gather(threshold, n, -c(LabId, Group.5b)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
filter(threshold %in% "Above") %>%
left_join(n.ind2) %>%
left_join(r) %>%
filter(Group.5b %in% c("PCR+ Seropositive", "PCR+ Seronegative",
"Exposed Seropositive", "Exposed Seronegative")) %>%
ggplot(aes(y=IgG, x=as.numeric(n))) +
geom_jitter(aes(color=Group.5b), width=0.3, alpha=0.6) +
#scale_y_continuous(trans="log2") +
scale_y_continuous(trans="log2", breaks=c(0.1, 1, 10, 100),
labels=c(0.1, 1, 10, 100)) +
xlab("Detected Antigens") + ylab("EI-S1-IgG") +
geom_hline(yintercept = 1.015, col="grey", lty=2) +
scale_color_manual(values=cbPalette[c(1, 6, 8, 4)], name="Group") +
ggpubr::stat_cor(aes(color = Group.5b, y=IgG,
x=as.numeric(n), hjust=1, vjust=1),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.2,
show.legend=FALSE, size=3) +
ggpubr::stat_cor(aes(y=IgG, x=as.numeric(n), hjust=0, vjust=0),
method="spearman", cor.coef.name = "rho",
p.accuracy=0.001, r.accuracy=0.01,
label.x.npc="left", label.y.npc = 0.25,
show.legend=FALSE, size=3)
fig4c
plot_grid(fig4b, fig4c, labels=c("A", "B"),
rel_widths=c(0.5, 0.5))
library(dplyr)
library(ggplot2)
library(tidyr)
library(ggthemes)
library(colorspace)
library(readxl)
library(forcats)
library(scales)
library(gridExtra)
library(cowplot)
library(Cairo)
library(stringr)
library(ggpubr)
library(rstatix)
library(EnvStats)
library(lme4)
library(effects)
library(broom)
library(broom.mixed)
library(extrafont)
loadfonts(quiet = TRUE)
library(ggthemes)
# Define theme and colors
theme_set(theme_classic())
theme_update(strip.background = element_rect(colour = "white", fill = "white"))
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
here_r = function (...) here::here("Statistics", ...)
here_data_tcell = function (...) here::here("Data-t-cell", ...)
here_output = function (...) here::here("Output", ...)
# Load data of t-cell
load(here_data_tcell("data-raw-tcell-210315.RData"))
data <- data %>%
rename(NC = "Capsid sub x5",
M = "Membrane sub x5",
SNT = "SNT sub x5",
SCT = "SCT sub x5",
`Pepmix (green)` = "grün sbu x5",
`Pepmix (yellow)` = "yellow sub x5")
data.long <- data.long %>%
mutate(Antigen = case_when(
Antigen == "Capsid sub x5" ~ "NC",
Antigen == "Membrane sub x5" ~ "M",
Antigen == "SNT sub x5" ~ "SNT",
Antigen == "SCT sub x5" ~ "SCT",
Antigen == "grün sbu x5" ~ "Pepmix (green)",
Antigen == "yellow sub x5" ~ "Pepmix (yellow)"))
data.long <- data.long %>%
mutate(IgG = as.numeric(IgG))
data <- data %>%
mutate(IgG = as.numeric(IgG))
wt <- data.long %>%
mutate(value = ifelse(value == 0, 0.01, value)) %>%
filter(Group.5 %in% "PCR+ Seronegative") %>%
# filter(Antigen %in% "NC") %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
filter(!is.na(IgG)) %>%
select(LabId, Seropositivity.IgG,
IgG, Antigen, value)
head(wt)
# NON BONFERRONI CORRECTION
stat.test <- wt %>%
group_by(Antigen) %>%
wilcox_test(value ~ Seropositivity.IgG) %>%
# adjust_pvalue(method = "bonferroni") %>%
add_significance()
data.frame(stat.test)
stat.test <- stat.test %>% add_xy_position(x = "Seropositivity.IgG")
stat.test
data.long %>%
mutate(value = ifelse(value == 0, 0.01, value)) %>%
filter(Group.5 %in% "PCR+ Seronegative") %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
filter(!is.na(IgG)) %>%
ggplot(aes(x=Seropositivity.IgG, y=value)) +
geom_jitter(width=0.1, alpha=0.4, color=cbPalette[8]) +
facet_wrap(~(Antigen), ncol=4) +
geom_hline(yintercept = 40, col="grey", lty=2) +
# stat_summary(geom = "point", fun = "median", col = "black",
#              size = 7, shape=95) +
ylab(expression(paste("IFN", gamma, " (mU/ml)"))) +
xlab("EI-S1-IgG") +
scale_y_continuous(trans="log2", breaks=c(0.01, 5, 40, 250, 1000),
labels=c(0, 5, 40, 250, 1000)) +
stat_n_text(size=3, y.pos=-8) +
stat_pvalue_manual(stat.test, y.position=12)
data.long %>%
mutate(value = ifelse(value == 0, 0.01, value)) %>%
filter(Group.5 %in% "PCR+ Seronegative") %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
filter(!is.na(IgG)) %>%
ggplot(aes(x=Seropositivity.IgG, y=value)) +
geom_jitter(width=0.1, alpha=0.4, color=cbPalette[8]) +
facet_wrap(~(Antigen), ncol=4) +
geom_hline(yintercept = 40, col="grey", lty=2) +
# stat_summary(geom = "point", fun = "median", col = "black",
#              size = 7, shape=95) +
ylab(expression(paste("IFN", gamma, " (mIU/ml)"))) +
xlab("EI-S1-IgG") +
scale_y_continuous(trans="log2", breaks=c(0.01, 5, 40, 250, 1000),
labels=c(0, 5, 40, 250, 1000)) +
stat_n_text(size=3, y.pos=-8) +
stat_pvalue_manual(stat.test, y.position=12)
ggsave("Figure-S1.pdf", height=4, width=6)
# WITH BONFERRONI CORRECTION
stat.test <- wt %>%
group_by(Antigen) %>%
wilcox_test(value ~ Seropositivity.IgG) %>%
adjust_pvalue(method = "bonferroni") %>%
add_significance()
data.frame(stat.test)
stat.test <- stat.test %>% add_xy_position(x = "Seropositivity.IgG")
stat.test
data.long %>%
mutate(value = ifelse(value == 0, 0.01, value)) %>%
filter(Group.5 %in% "PCR+ Seronegative") %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
filter(!is.na(IgG)) %>%
ggplot(aes(x=Seropositivity.IgG, y=value)) +
geom_jitter(width=0.1, alpha=0.4, color=cbPalette[8]) +
facet_wrap(~(Antigen), ncol=4) +
geom_hline(yintercept = 40, col="grey", lty=2) +
# stat_summary(geom = "point", fun = "median", col = "black",
#              size = 7, shape=95) +
ylab(expression(paste("IFN", gamma, " (mU/ml)"))) +
xlab("EI-S1-IgG") +
scale_y_continuous(trans="log2", breaks=c(0.01, 5, 40, 250, 1000),
labels=c(0, 5, 40, 250, 1000)) +
stat_n_text(size=3, y.pos=-8) +
stat_pvalue_manual(stat.test, y.position=12)
#------------------------------------------------ SI Figure
# Figure for sampling dates (Kinetics)
data.long %>%
filter(Antigen %in% c("NC", "M","SCT", "SNT")) %>%
filter(!is.na(Group.5)) %>%
filter(Group.3 %in% "PCR+") %>%
mutate(value = ifelse(value == 0, 0.1, value)) %>%
mutate(datediff = VisitDate - TestDate) %>%
mutate(datediff = as.numeric(datediff)) %>%
filter(datediff > 100) %>%
ggplot() +
geom_point(aes(x=datediff, y=value, color=Group.5), alpha=0.5) +
scale_y_continuous(trans="log2", breaks=c(0.1, 5, 40, 250, 2500),
labels=c("0", "5", "40", "250", "2500")) +
xlab("Days between PCR test and sample measurement") +
ylab(expression(paste("IFN", gamma, " (mU/ml)"))) +
#  facet_wrap(~Antigen) +
geom_hline(yintercept = 40, col="grey", lty=2) +
stat_smooth(aes(x=datediff, y=value), lty=1, se=FALSE,
formula = y ~ x, method="lm", color="grey50") +
# stat_smooth(data = .%>%filter(Antigen %in% "Membrane"),
#             aes(x=datediff, y=value), lty=1, se=FALSE,
#             color="red",
#             formula = y ~ x, method="lm") +
# stat_smooth(data = .%>%filter(Antigen %in% "Capsid"),
#             aes(x=datediff, y=value), lty=1, se=FALSE,
#             color="blue",
#             formula = y ~ x, method="lm") +
#
# stat_smooth(data=.%>%filter(Group.5 %in% "PCR+ Seropositive"),
#             aes(x=datediff, y=value), lwd=1, se=FALSE,
#             color=cbPalette[4],
#             formula = y ~ poly(x,2), method="lm") +
# stat_smooth(data=.%>%filter(Group.5 %in% "PCR+ Seronegative"),
#                          aes(x=datediff, y=value), lty=1, se=FALSE,
#                          color=cbPalette[2],
#                          formula = y ~ x, method="lm") +
# stat_smooth(data=.%>%filter(Group.5 %in% "PCR+ Seronegative"),
#             aes(x=datediff, y=value), lwd=1, se=FALSE,
#             color=cbPalette[2],
#             formula = y ~ poly(x,2), method="lm") +
scale_color_manual(values=cbPalette[c(8,4)], name="Group") +
scale_fill_manual(values=cbPalette[c(8,4)], name="Group") +
facet_wrap(~fct_inorder(Antigen))
wt <- data.long %>%
mutate(value = ifelse(value == 0, 0.01, value)) %>%
filter(Group.5 %in% "PCR+ Seronegative") %>%
# filter(Antigen %in% "NC") %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
filter(!is.na(IgG)) %>%
select(LabId, Seropositivity.IgG,
IgG, Antigen, value)
head(wt)
# NON BONFERRONI CORRECTION
stat.test <- wt %>%
group_by(Antigen) %>%
wilcox_test(value ~ Seropositivity.IgG) %>%
# adjust_pvalue(method = "bonferroni") %>%
add_significance()
data.frame(stat.test)
stat.test <- stat.test %>% add_xy_position(x = "Seropositivity.IgG")
stat.test
data.long %>%
mutate(value = ifelse(value == 0, 0.01, value)) %>%
filter(Group.5 %in% "PCR+ Seronegative") %>%
filter(Antigen %in% c("NC", "M", "SCT", "SNT")) %>%
filter(!is.na(IgG)) %>%
ggplot(aes(x=Seropositivity.IgG, y=value)) +
geom_jitter(width=0.1, alpha=0.4, color=cbPalette[8]) +
facet_wrap(~(Antigen), ncol=4) +
geom_hline(yintercept = 40, col="grey", lty=2) +
# stat_summary(geom = "point", fun = "median", col = "black",
#              size = 7, shape=95) +
ylab(expression(paste("IFN", gamma, " (mIU/ml)"))) +
xlab("EI-S1-IgG") +
scale_y_continuous(trans="log2", breaks=c(0.01, 5, 40, 250, 1000),
labels=c(0, 5, 40, 250, 1000)) +
stat_n_text(size=3, y.pos=-8) +
stat_pvalue_manual(stat.test, y.position=12)
ggsave(here_output("Figure-S1.pdf"), height=4, width=6)
ggsave(here_output("Figure-S1.png"), height=4, width=6)
ggsave(here_output("Figure_S1.pdf"), height=4, width=6)
ggsave(here_output("Figure_S1.png"), height=4, width=6)
